"""
Authors: Bradley Fritz, Matt Gill
USDA ARS Droplet Size Models

This class is provides functional access for the running of the Droplet Size Models
using hard-coded data herein. Adapted by Matt Gill from previous work by Bradley Fritz, USDA ARS.
"""

import math

import numpy as np


class AtomizationModel:
    """
    Items from this list are used internally to determine droplet spectrum categories
    """

    ref_nozzles = {
        "VF": {
            "DV01": [0.0, 59.5],
            "DV05": [0.0, 134.4],
            "DV09": [134.4, 236.4],
            "RANK": 0,
            "Color": "#FF0000",
        },
        "F": {
            "DV01": [59.5, 110.3],
            "DV05": [134.4, 248.1],
            "RANK": 1,
            "DV09": [236.4, 409.4],
            "Color": "#FFA500",
        },
        "M": {
            "DV01": [110.3, 162.0],
            "DV05": [248.1, 357.8],
            "DV09": [409.4, 584.0],
            "RANK": 2,
            "Color": "#FFFF00",
        },
        "C": {
            "DV01": [162.0, 191.7],
            "DV05": [357.8, 431.0],
            "DV09": [584.0, 737.1],
            "RANK": 3,
            "Color": "#0000FF",
        },
        "VC": {
            "DV01": [191.7, 226.1],
            "DV05": [431.0, 500.9],
            "DV09": [737.1, 819.8],
            "RANK": 4,
            "Color": "#008000",
        },
        "XC": {
            "DV01": [226.1, 302.5],
            "DV05": [500.9, 658.6],
            "DV09": [819.8, 1142.2],
            "RANK": 5,
            "Color": "#D8D8D8",
        },
        "UC": {
            "DV01": [302.5, 65535],
            "DV05": [658.6, 65535],
            "DV09": [1142.2, 65535],
            "RANK": 6,
            "Color": "#000000",
        },
    }

    """
    Items from this list can be used externally as lookup keys in either LS or HS model based on the
    helper methods in this class
    """
    nozzles = [
        "CP11TT 20°FF",  # 0
        "CP11TT 40°FF",  # 1
        "CP11TT 60°FF",  # 2
        "CP11TT 80°FF",  # 3
        "CP11TT 110°FF",  # 4
        "CP11TT SS",  # 5
        "CP03",  # 6
        "CP09",  # 7
        "Davidon TriSet",  # 8
        "Steel Disc Core 45",  # 9
        "Ceramic Disc Core 45",  # 10
        "Steel Disc Core SS",  # 11
        "Ceramic Disc Core SS",  # 12
        "Standard 40°FF",  # 13
        "Standard 80°FF",
    ]  # 14

    """
    The below defines some common nozzles excluded from the models
    """
    excluded_dict = {
        "CP01": {"Orifice": [0.062, 0.078, 0.125, 0.172], "Angle": [30, 55, 90]},
        "CP07": {"Orifice": [0.062, 0.078, 0.125, 0.172], "Angle": [0, 5, 30]},
        "CP09A": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Angle": [30, 55, 90],
        },  # Australian
        "AccuFlo": {"Orifice": [0.016, 0.078, 0.125], "Angle": [0]},
        "Micronair": {
            "Orifice": ["AU4000", "AU5000", "AU6539", "AU7000"],
            "Angle": [0],
        },
    }

    # nozzles_extended = nozzles + ['CP01','CP07','AccuFlo','Micronair']
    nozzles_extended = nozzles + list(excluded_dict.keys())

    """
    The below defines the models for both low-speed (<120 mph) and high-speed (>120 mph) conditions as well
    as dictionaries with each models orifice, angle and model coefficients
    """
    hs_dict = {
        "CP11TT 20°FF": {
            "Orifice": [4, 6, 8, 10, 12, 15, 20],
            "Flow": [0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [12, 8, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                87.49491525,
                14.50555556,
                -28.45555556,
                6.288888889,
                -49.25,
                -6.1125,
                3.3125,
                1.9125,
                -4.55,
                14.6,
                -6.125,
                -4.82740113,
                4.82259887,
                0.92259887,
                15.67259887,
            ],
            "DV50": [
                217.3830509,
                34.12222222,
                -62.21111111,
                12.2,
                -104.9611111,
                -16.7,
                8.9875,
                1.5375,
                -17.7,
                35.775,
                -20.7375,
                -6.346892655,
                13.25310735,
                1.253107345,
                28.40310735,
            ],
            "DV90": [
                382.3559322,
                85.55,
                -115.9388889,
                26,
                -213.8277778,
                -28.0375,
                15.425,
                0.5,
                -52.4875,
                67.0375,
                -43.6,
                -6.365254237,
                27.83474576,
                5.184745763,
                63.43474576,
            ],
            "V100": [
                12.82981356,
                -3.445888889,
                6.016888889,
                0.498777778,
                11.76516667,
                -0.5895625,
                -0.5198125,
                0.0324375,
                -2.4668125,
                2.8744375,
                1.8526875,
                1.830717514,
                0.090717514,
                -0.319282486,
                2.938217514,
            ],
            "V141": [
                23.95221247,
                -5.355571204,
                9.844064685,
                0.442419852,
                19.23756998,
                -0.70728625,
                -0.56210275,
                -0.411648417,
                -3.239132,
                3.769397917,
                2.98260625,
                2.471717564,
                0.081012231,
                -0.788396603,
                4.807193897,
            ],
            "V200": [
                44.24745763,
                -6.683333333,
                12.77222222,
                -0.661111111,
                26.16666667,
                0.35,
                -0.1,
                -2.2625,
                -2.1,
                1.0375,
                3.8625,
                2.861299435,
                -0.438700565,
                -1.038700565,
                3.011299435,
            ],
        },
        "CP11TT 40°FF": {
            "Orifice": [4, 6, 8, 10, 12, 15, 20, 25, 30],
            "Flow": [0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 2.5, 3.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [17, 13, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                82.84866033,
                9.84709259,
                -24.89310981,
                2.062483085,
                -42.54191849,
                -5.981007147,
                3.289093942,
                -0.059645835,
                -3.618982088,
                16.88964583,
                -7.753937499,
                -7.574678223,
                3.029208108,
                0.236374758,
                16.87654142,
            ],
            "DV50": [
                208.4340329,
                30.96142594,
                -57.69716513,
                6.093937279,
                -93.13301071,
                -16.71141049,
                9.100663491,
                -0.349000002,
                -13.47837656,
                33.78825,
                -18.14216666,
                -20.3662598,
                10.1757448,
                -1.959088504,
                35.38474485,
            ],
            "DV90": [
                368.0412404,
                82.72361113,
                -106.5265994,
                17.95924376,
                -189.7159967,
                -30.69772993,
                21.62459233,
                -8.862187519,
                -48.86138995,
                60.52297918,
                -41.84106251,
                -38.30284397,
                27.12827497,
                -5.021058376,
                79.43277497,
            ],
            "V100": [
                14.30593713,
                -3.823322166,
                6.348120857,
                1.259409871,
                12.84953384,
                -1.096792416,
                0.029361681,
                -0.244638063,
                -3.090121511,
                2.264351354,
                2.389611646,
                3.302282473,
                0.320777366,
                -0.357917634,
                2.426008531,
            ],
            "V141": [
                26.853111,
                -5.764995778,
                10.27643744,
                1.325385136,
                20.35383209,
                -1.17089934,
                0.225585062,
                -1.09205075,
                -4.097431318,
                2.726994792,
                3.269342417,
                5.186727464,
                0.782564923,
                -0.867423577,
                2.352306423,
            ],
            "V200": [
                49.09279815,
                -6.652758482,
                12.9750489,
                0.841697536,
                25.96732927,
                0.39193563,
                0.390930513,
                -2.703123541,
                -2.617470314,
                -0.875733249,
                4.047340499,
                6.874776674,
                -0.269282238,
                -1.041777908,
                -1.830584738,
            ],
        },
        "CP11TT 80°FF": {
            "Orifice": [2, 3, 4, 5, 6, 8, 10, 12, 15, 20, 25, 30],
            "Flow": [0.2, 0.3, 0.4, 0.5, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 2.5, 3.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [16, 14, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                80.3910781,
                15.38007407,
                -19.14014325,
                0.005669567,
                -24.75770925,
                -7.02971596,
                1.783032526,
                0.382250004,
                -8.585032673,
                7.830874999,
                -2.382166663,
                -13.02319862,
                2.753989636,
                -0.801510344,
                9.396656301,
            ],
            "DV50": [
                198.7351429,
                40.90783334,
                -41.15219441,
                0.270291724,
                -53.59343925,
                -16.12449653,
                4.820090764,
                2.919770827,
                -21.86734512,
                13.4514375,
                -4.929104173,
                -29.74704027,
                5.951218493,
                -2.730781557,
                17.85255179,
            ],
            "DV90": [
                345.2431166,
                87.85842592,
                -66.27101267,
                3.271584173,
                -110.8328236,
                -23.32559582,
                11.59793892,
                12.21035418,
                -52.55243671,
                19.38143751,
                -15.22756249,
                -55.80807989,
                8.083090411,
                -9.317742939,
                48.94975706,
            ],
            "V100": [
                16.11051463,
                -6.648688611,
                7.817833935,
                0.554978962,
                9.947956556,
                -1.526330193,
                -0.384342173,
                0.285909834,
                -1.652032616,
                2.652337791,
                1.036204584,
                6.425214762,
                -0.362790111,
                -1.242262445,
                1.748386555,
            ],
            "V141": [
                29.87259398,
                -10.79485176,
                12.1557981,
                0.738943165,
                15.31993034,
                -1.254877809,
                -0.748878859,
                -0.508385979,
                -1.013429466,
                3.288138438,
                1.272975896,
                10.10668704,
                -0.217496028,
                -2.003109528,
                2.197565805,
            ],
            "V200": [
                52.98317543,
                -13.3,
                13.28022309,
                0.795725921,
                18.07469901,
                1.708109065,
                -1.238533994,
                -2.29375,
                3.112075071,
                -0.23125,
                1.53125,
                12.10100536,
                -0.910734463,
                -1.360734463,
                -0.460734463,
            ],
        },
        "CP03": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Flow": [0.68, 1.02, 2.454, 3.37],
            "Angle": [30, 55, 90],
            "Adjust": [0.1165, 0.0555, 150, 30, 60, 30, 60, 30],
            "Speed": [120, 180],
            "DV10": [
                82.87720123,
                3.246053172,
                -22.57192844,
                -1.953681671,
                -15.81245226,
                -2.540138834,
                1.449138393,
                1.268885209,
                0.597843129,
                4.949189347,
                -1.766251508,
                5.194582361,
                2.574949749,
                0.56484178,
                -5.332182448,
            ],
            "DV50": [
                198.7792553,
                16.36749142,
                -52.6884686,
                1.910267315,
                -35.60040998,
                -8.450838409,
                2.814146996,
                -0.926123868,
                0.172433055,
                10.71232423,
                -4.657699683,
                1.450510201,
                8.931696955,
                1.012097024,
                -3.840227246,
            ],
            "DV90": [
                359.3420752,
                50.51741552,
                -109.3463618,
                25.8239601,
                -84.97819099,
                -23.96242861,
                4.15252347,
                -28.36083748,
                5.898855397,
                18.74296023,
                -7.831338065,
                -14.64847387,
                29.24847214,
                26.83973765,
                -13.89836775,
            ],
            "V100": [
                14.27267516,
                -1.537438156,
                7.40535708,
                0.641869582,
                5.463887788,
                0.044617789,
                -0.55248316,
                -0.245823302,
                -1.211125882,
                1.461451456,
                0.870029928,
                -0.221912192,
                1.071694953,
                -0.032098969,
                2.099561739,
            ],
            "V141": [
                27.30563192,
                -3.512911995,
                13.31752932,
                0.95120834,
                9.45085038,
                -0.097858389,
                -1.328085424,
                -0.445111755,
                -1.98501439,
                2.444922919,
                1.369307831,
                0.500734838,
                1.335698697,
                -0.088525355,
                3.283713929,
            ],
            "V200": [
                50.43125108,
                -6.045324862,
                18.3019265,
                0.652771881,
                13.09133341,
                0.747419973,
                -2.408190247,
                0.086675672,
                -1.740865709,
                1.407266938,
                1.896367571,
                1.561957126,
                -0.832278715,
                -1.408636426,
                4.474634242,
            ],
        },
        "Steel Disc Core 45": {
            "Orifice": [2, 4, 6, 8, 10, 12, 14, 16],
            "Flow": [0.2, 0.36, 0.58, 0.84, 1.1, 1.36, 1.53, 1.79],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [9, 7, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                71.07988426,
                6.408277778,
                -17.77781759,
                -0.984157145,
                -8.495773095,
                -4.146508201,
                0.832433165,
                1.164041668,
                0.377128301,
                -1.0905,
                -1.537041666,
                -2.476474653,
                3.669033896,
                -0.672299434,
                -3.471799434,
            ],
            "DV50": [
                179.4538835,
                23.30157409,
                -35.55823255,
                -2.027162809,
                -18.69019354,
                -11.82131797,
                -0.553923165,
                3.429145844,
                3.722307403,
                -0.289395835,
                -2.197395831,
                -14.56585429,
                4.392037642,
                -0.897962309,
                -8.319129009,
            ],
            "DV90": [
                350.5048619,
                54.76342592,
                -63.14502177,
                -0.390516869,
                -21.39412019,
                -23.70920523,
                -0.515563076,
                5.048854156,
                18.21226122,
                2.343395844,
                -2.641729169,
                -34.52208127,
                8.246797561,
                3.830630861,
                -44.75820244,
            ],
            "V100": [
                18.2467119,
                -5.525358221,
                10.46253982,
                0.594427529,
                6.583765366,
                -1.002647218,
                -0.391000712,
                -0.634345729,
                -3.276052796,
                3.925032646,
                1.377036479,
                3.15927614,
                1.516661888,
                0.187894558,
                3.043960723,
            ],
            "V141": [
                33.71945138,
                -9.171146852,
                14.44711853,
                0.484602551,
                8.571219693,
                1.092159074,
                -0.010550477,
                -1.672671479,
                -4.069750498,
                2.818417063,
                1.578559146,
                6.274391455,
                1.37526148,
                0.503440314,
                3.87371198,
            ],
            "V200": [
                57.47569444,
                -10.61666667,
                14.42302036,
                0.433144796,
                7.20418552,
                4.600282805,
                0.338122172,
                -1.91875,
                -2.886312217,
                -1.06875,
                1.14375,
                7.682780132,
                -0.690677966,
                0.409322034,
                4.609322034,
            ],
        },
        "Ceramic Disc Core 45": {
            "Orifice": [2, 4, 6, 8, 10],
            "Flow": [0.2, 0.36, 0.58, 0.84, 1.1, 1.36, 1.53, 1.79],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [6, 4, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                71.18469492,
                10.06181482,
                -17.17031482,
                0.822425924,
                -12.48901852,
                -6.517854168,
                -1.728770836,
                1.805687502,
                -1.596854169,
                1.068770836,
                0.839687503,
                -1.456199622,
                3.102967043,
                -2.196699622,
                0.366967043,
            ],
            "DV50": [
                176.9451073,
                27.35135187,
                -37.03585185,
                1.799314813,
                -27.82937036,
                -13.51283333,
                -3.033375008,
                4.524124996,
                -3.721250004,
                1.520666667,
                1.364124996,
                -10.71856968,
                4.017263666,
                -3.990569684,
                -0.365736334,
            ],
            "DV90": [
                333.158113,
                57.96183334,
                -69.99429629,
                7.727351856,
                -47.54424074,
                -29.89302084,
                1.2960625,
                6.414895838,
                -4.089937513,
                4.5010625,
                1.061729163,
                -26.86152076,
                9.012645944,
                0.010812644,
                -27.20352071,
            ],
            "V100": [
                18.94426334,
                -6.752275779,
                10.19513494,
                -1.773000037,
                8.418071149,
                -1.217860417,
                1.403739208,
                -0.964485875,
                -2.962515335,
                4.46792775,
                -1.124719625,
                2.716523767,
                1.651409597,
                0.613479432,
                1.650738762,
            ],
            "V141": [
                34.90013825,
                -9.874377019,
                14.67388035,
                -1.708670426,
                11.56713806,
                0.563932875,
                1.24639925,
                -1.72037825,
                -2.421046083,
                4.57566025,
                -0.474629042,
                4.573034321,
                1.832562654,
                1.249171988,
                2.027291321,
            ],
            "V200": [
                59.4779661,
                -11.06666667,
                14.88888889,
                -0.927777778,
                11.11111111,
                4.8375,
                0.45,
                -2.1875,
                0.025,
                0.2375,
                0.375,
                5.609039548,
                -0.190960452,
                1.359039548,
                2.009039548,
            ],
        },
        "Standard 40°FF": {
            "Orifice": [2, 4, 6, 8, 10, 12, 15, 20, 30],
            "Flow": [0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 3.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [16, 14, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                85.60496231,
                9.583805557,
                -22.16106126,
                -0.567469079,
                -38.6736771,
                -6.518886246,
                2.060729196,
                4.176343752,
                -1.110815476,
                10.96026041,
                -2.947197919,
                -6.716207603,
                0.130449617,
                -2.835050368,
                14.27894962,
            ],
            "DV50": [
                223.0997929,
                39.61391667,
                -52.04873394,
                2.798174286,
                -80.80058289,
                -18.29364178,
                3.166126678,
                6.714468752,
                -11.79494423,
                20.86921875,
                -9.855197923,
                -27.79186492,
                3.315995738,
                -7.111337562,
                24.20982909,
            ],
            "DV90": [
                401.7904672,
                95.06610184,
                -86.99491956,
                13.9647856,
                -165.139596,
                -23.78403029,
                8.126821112,
                14.57438541,
                -41.66559211,
                32.22896876,
                -31.81232291,
                -53.47372382,
                0.54320385,
                -6.80312945,
                60.29637055,
            ],
            "V100": [
                12.98161462,
                -5.833300658,
                8.002446315,
                0.347628349,
                14.19392082,
                -1.900799785,
                0.370191122,
                -0.436633697,
                -5.623381137,
                4.342851635,
                1.206351302,
                3.495639349,
                2.085829293,
                0.858521627,
                2.610722127,
            ],
            "V141": [
                24.79254492,
                -8.281392019,
                11.32281604,
                0.456722807,
                20.43067791,
                -0.977771623,
                0.497209048,
                -1.548144938,
                -6.312270656,
                4.073580479,
                1.866534063,
                5.792719704,
                2.508082344,
                0.15466951,
                2.987274177,
            ],
            "V200": [
                45.4911051,
                -9.648525741,
                13.03543423,
                0.373295084,
                23.73309241,
                1.51792739,
                0.440322258,
                -3.294778353,
                -3.140545033,
                -0.462337604,
                2.942163729,
                8.113914177,
                1.196720575,
                -1.09152392,
                1.02512791,
            ],
        },
        "Standard 80°FF": {
            "Orifice": [2, 4, 6, 8, 10, 12, 15, 20, 30],
            "Flow": [0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 3.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [16, 14, 150, 30, 60, 30, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                80.8320587,
                9.146185186,
                -17.19349041,
                -1.663129579,
                -29.1637008,
                -6.203125685,
                1.115339608,
                2.232958334,
                -3.0049678,
                7.06583333,
                -1.683041666,
                -6.363329885,
                0.918101691,
                -4.621398304,
                7.951768361,
            ],
            "DV50": [
                206.7940213,
                36.07870371,
                -40.26813286,
                -2.297706658,
                -60.08264631,
                -15.15307236,
                2.601293044,
                6.349770842,
                -13.82010116,
                12.06947915,
                -4.916979171,
                -27.61925296,
                5.31754521,
                -8.30078814,
                12.74071186,
            ],
            "DV90": [
                370.7755238,
                83.11374074,
                -67.99461483,
                -0.973534978,
                -124.2546288,
                -21.66546947,
                4.659926599,
                14.21656249,
                -42.08856372,
                18.60735416,
                -15.74427083,
                -60.15489849,
                13.00837662,
                -18.22229003,
                37.00270997,
            ],
            "V100": [
                14.75319835,
                -5.985391259,
                8.009198773,
                0.841288606,
                13.31736675,
                -1.561509236,
                -0.39705694,
                -0.042997395,
                -4.404653002,
                3.947774146,
                1.157114437,
                4.067458373,
                1.579186088,
                1.288472758,
                2.419769254,
            ],
            "V141": [
                27.98836477,
                -9.198656963,
                11.43617469,
                1.165016736,
                18.8099522,
                -0.720028825,
                -0.122631242,
                -1.740692021,
                -3.960437786,
                3.844026396,
                1.401360938,
                7.659514538,
                1.646395622,
                0.643899122,
                2.806839289,
            ],
            "V200": [
                50.42982117,
                -10.995825,
                12.14804393,
                1.503816882,
                20.65353097,
                2.109128949,
                0.005925732,
                -3.583903333,
                0.608531554,
                -0.518259249,
                2.032396499,
                10.44912775,
                -0.01602319,
                -0.12264686,
                1.043481305,
            ],
        },
        "CP09": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Flow": [0.635, 0.95, 1.972, 2.575],
            "Angle": [0, 5, 30],
            "Adjust": [0.117, 0.055, 150, 30, 60, 30, 15, 15],
            "Speed": [120, 180],
            "DV10": [
                62.27593827,
                -5.061593839,
                -41.38493853,
                11.46116091,
                -37.45180122,
                4.943758421,
                -11.39164729,
                -13.51023316,
                10.83256967,
                14.03421454,
                -10.24010557,
                -2.758076926,
                14.04449747,
                3.597247276,
                54.38540591,
            ],
            "DV50": [
                109.2069862,
                -10.94659487,
                -112.5253385,
                44.39791306,
                -114.8312667,
                18.04091594,
                -38.10777543,
                -48.8316896,
                27.66762433,
                41.80015979,
                -32.80224909,
                -12.36069891,
                43.64815105,
                13.78894125,
                190.5734642,
            ],
            "DV90": [
                300.8848197,
                25.45147408,
                -214.0946506,
                94.43978232,
                -208.9856681,
                21.5471939,
                -56.61608309,
                -122.74202,
                36.3935015,
                69.86776382,
                -55.29595045,
                18.63844655,
                91.2341122,
                52.82738104,
                199.7445874,
            ],
            "V100": [
                10.93644068,
                -0.740542971,
                5.4778441,
                -0.254027237,
                4.139637644,
                -0.033450594,
                -0.32826793,
                0.167102127,
                -1.433369782,
                0.958665482,
                0.336697655,
                -0.190145433,
                1.246052444,
                0.055089603,
                -1.85658382,
            ],
            "V141": [
                22.0011087,
                -1.751858471,
                10.10809044,
                -0.790843284,
                7.851546674,
                -0.248640449,
                -0.731360219,
                0.359594589,
                -2.840197857,
                1.971146686,
                0.332416223,
                -0.075040025,
                2.242870299,
                -0.291447799,
                -4.440978019,
            ],
            "V200": [
                41.06993981,
                -3.40734368,
                16.28449751,
                -2.145513289,
                13.24687385,
                -0.746783807,
                -0.542499241,
                0.552321803,
                -4.679794457,
                2.499680448,
                0.396778611,
                0.307030857,
                1.949876885,
                -1.185733918,
                -7.151724713,
            ],
        },
        "CP11TT SS": {
            "Orifice": [6, 8, 10, 12, 15, 20, 25],
            "Flow": [0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 2.5],
            "Angle": [0, 15, 30, 45],
            "Adjust": [15.5, 9.5, 150, 30, 60, 30, 22.5, 22.5],
            "Speed": [120, 180],
            "DV10": [
                119.4534746,
                -10.18718519,
                -54.71966667,
                21.50851852,
                -52.89233333,
                3.427333333,
                -1.829166667,
                -12.08825,
                14.61495833,
                28.33620833,
                -20.24145833,
                3.744779661,
                15.78677966,
                0.981779661,
                7.304112994,
            ],
            "DV50": [
                291.0903531,
                -14.87280556,
                -127.5480648,
                59.55012037,
                -123.687713,
                7.43434375,
                -8.568739583,
                -37.51092708,
                27.65230208,
                64.70244792,
                -53.62630208,
                7.177532486,
                39.11869915,
                2.844365819,
                18.81519915,
            ],
            "DV90": [
                568.6659944,
                -9.186925926,
                -233.8423148,
                126.4276482,
                -240.1379444,
                2.839625,
                -23.45329167,
                -90.154875,
                48.17108333,
                112.0114167,
                -117.52575,
                28.21839548,
                92.33589548,
                -2.669437853,
                -2.392771186,
            ],
            "V100": [
                6.795512757,
                0.169773741,
                5.329054982,
                -1.133546593,
                4.754688982,
                0.186558854,
                0.151433313,
                -0.496685187,
                -1.136621188,
                1.870913979,
                0.504026521,
                -0.143659772,
                0.976826395,
                0.284199561,
                1.569961728,
            ],
            "V141": [
                13.46713788,
                0.096768167,
                9.524752352,
                -2.030945611,
                8.65663963,
                0.215344021,
                0.327256979,
                -0.900676104,
                -1.933785188,
                2.954369979,
                0.878025938,
                -0.287489417,
                1.520755916,
                0.488951249,
                2.440241416,
            ],
            "V200": [
                26.3551346,
                0.202010528,
                15.2494319,
                -3.768493991,
                13.96806032,
                0.057953969,
                0.373355552,
                -0.999832469,
                -3.15536799,
                3.576139156,
                1.883579073,
                -0.509847473,
                1.699408694,
                0.77687936,
                2.973329527,
            ],
        },
        "Disc Core SS": {
            "Orifice": [2, 3, 4, 5, 6, 7, 8, 10, 12],
            "Flow": [0.2, 0.27, 0.45, 0.74, 1.05, 1.41, 1.86, 2.71, 3.42],
            "Angle": [0, 15, 30, 45],
            "Adjust": [7, 5, 150, 30, 60, 30, 22.5, 22.5],
            "Speed": [120, 180],
            "DV10": [
                127.1901808,
                -13.25509259,
                -57.61296297,
                17.34274074,
                -56.94357407,
                6.3485625,
                -3.402020834,
                -9.123187501,
                23.84047916,
                33.34964584,
                -16.26735417,
                -16.081822,
                16.3050113,
                2.386677951,
                17.42017795,
            ],
            "DV50": [
                316.8280282,
                -18.51666667,
                -131.2386111,
                46.8677037,
                -123.7915556,
                11.72408334,
                -9.731,
                -26.86829168,
                39.62154166,
                68.33741666,
                -39.45908333,
                -34.77031072,
                37.87585593,
                1.088689279,
                34.03635593,
            ],
            "DV90": [
                635.7533729,
                12.31472223,
                -246.1202778,
                112.5646667,
                -228.9845741,
                12.03485414,
                -10.61564581,
                -76.51277084,
                44.08485414,
                127.3541459,
                -102.1506042,
                -69.10060169,
                72.28239831,
                13.52656496,
                19.03939836,
            ],
            "V100": [
                6.129079751,
                -0.28723137,
                5.457615148,
                -0.886364833,
                4.885492352,
                0.324063938,
                0.254286479,
                -0.330180063,
                -2.000596646,
                1.515253979,
                0.448519771,
                2.075281957,
                0.775467957,
                -0.001570876,
                1.07916779,
            ],
            "V141": [
                12.20641724,
                -0.440465759,
                9.557934315,
                -1.779572389,
                8.73071937,
                0.42043775,
                0.509860583,
                -0.660443042,
                -3.3838105,
                2.473797208,
                0.611520625,
                3.55524289,
                1.202493223,
                0.09623689,
                1.41683939,
            ],
            "V200": [
                24.02855843,
                -0.434827315,
                15.33644359,
                -3.314160815,
                14.01745756,
                0.476437208,
                1.003236583,
                -0.998642917,
                -5.04622625,
                2.646040335,
                1.199462375,
                5.433200335,
                1.2741815,
                0.173220165,
                1.08192083,
            ],
        },
        "Davidon TriSet": {
            "Orifice": [0.061, 0.078, 0.125],
            "Flow": [0.682, 1.062, 2.454],
            "Angle": [0, 22.5, 45],
            "Adjust": [0.0935, 0.0315, 150, 30, 60, 30, 22.5, 22.5],
            "Speed": [120, 180],
            "DV10": [
                102.5435005,
                -7.711244887,
                -58.01604157,
                26.94461891,
                -67.51026087,
                -0.986010739,
                20.20180103,
                -18.1157006,
                4.308675191,
                45.40926055,
                -30.80488274,
                2.762282783,
                13.10168897,
                -0.320639367,
                30.56785563,
            ],
            "DV50": [
                242.7426141,
                -4.428274949,
                -134.3128712,
                74.36805901,
                -167.4649469,
                -8.149670679,
                55.85175495,
                -47.41769484,
                5.682873448,
                105.0998494,
                -82.37988859,
                -3.709194019,
                30.62096877,
                2.614081893,
                92.30363537,
            ],
            "DV90": [
                451.5392751,
                12.21055625,
                -216.9586316,
                133.8671205,
                -307.6643335,
                -9.446844495,
                90.73748661,
                -79.06489045,
                -3.383543943,
                162.5247876,
                -144.683443,
                -16.09626762,
                53.05773156,
                -0.429158277,
                151.8335649,
            ],
            "V100": [
                8.915930791,
                0.706834728,
                5.23152871,
                -0.839318067,
                6.27342627,
                0.224650553,
                0.627688082,
                -0.38842854,
                -0.114724855,
                1.430681707,
                0.943151207,
                0.801651895,
                0.571956955,
                -0.2824627,
                0.632502625,
            ],
            "V141": [
                17.70986037,
                0.779113717,
                9.733276243,
                -1.85634655,
                11.69396452,
                0.151470204,
                0.839928281,
                -0.801861468,
                -0.573930244,
                2.675385227,
                1.435160634,
                1.551912367,
                1.03122863,
                -0.553312295,
                0.40461113,
            ],
            "V200": [
                35.25481133,
                0.535238567,
                15.69888372,
                -3.703134695,
                19.68262373,
                -0.178762987,
                1.589173499,
                -1.25590204,
                -1.486738458,
                2.896360855,
                2.579919789,
                2.775646045,
                0.095499496,
                -0.443665318,
                -2.006839834,
            ],
        },
        "CP11TT 60°FF": {
            "Orifice": [40],
            "Flow": [4.0],
            "Angle": [0, 15, 30, 45, 60, 75, 90],
            "Adjust": [0, 1, 150, 30, 45, 15, 45, 45],
            "Speed": [120, 180],
            "DV10": [
                75.65233333,
                0,
                -28.41885833,
                1.064175,
                -26.52804167,
                0,
                0,
                -1.3158625,
                0,
                11.885575,
                -1.856304167,
                0,
                2.3082875,
                -0.069483333,
                11.7432875,
            ],
            "DV50": [
                187.66,
                0,
                -62.6289,
                2.7915,
                -61.2409,
                0,
                0,
                -2.696983333,
                0,
                26.70093333,
                -5.906183333,
                0,
                5.327383333,
                1.3803,
                27.34421667,
            ],
            "DV90": [
                343.0336667,
                0,
                -105.2179667,
                4.995233333,
                -154.4741667,
                0,
                0,
                -11.94063333,
                0,
                42.47595,
                -13.19711667,
                0,
                5.907183333,
                7.072016667,
                83.74693333,
            ],
            "V100": [
                16.579871,
                0,
                8.942846175,
                -0.315860958,
                7.810355292,
                0,
                0,
                0.116490454,
                0,
                2.443375475,
                0.212531213,
                0,
                2.519365904,
                -0.28125245,
                -0.686416096,
            ],
            "V141": [
                30.89671167,
                14.42595248,
                0,
                -0.324644625,
                12.67362623,
                0,
                0,
                -0.048173429,
                0,
                2.629338425,
                0.622467179,
                0,
                2.789709171,
                -0.265576267,
                -1.436830413,
            ],
            "V200": [
                54.96012633,
                0,
                18.0988965,
                -0.112886833,
                17.50006167,
                0,
                0,
                0.156786583,
                0,
                -0.277276,
                0.88830575,
                0,
                0.25582125,
                -0.857066167,
                -3.244749917,
            ],
        },
    }

    ls_dict = {
        "CP11TT 20°FF": {
            "Orifice": [4, 6, 8, 10, 12, 15, 20],
            "Flow": [0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0],
            "Angle": [0, 15, 30, 45],
            "Adjust": [12, 8, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                258.6998842,
                57.21952777,
                -82.68560185,
                -33.17645371,
                -72.42923149,
                -40.45755208,
                -11.80242708,
                37.85082292,
                -17.93257292,
                12.09551041,
                16.18596876,
                -6.790253751,
                3.603912899,
                -28.7247538,
                23.65474625,
            ],
            "DV50": [
                621.3991964,
                146.2486806,
                -152.4464861,
                -48.42717132,
                -116.7462176,
                -88.25405731,
                -17.81255733,
                56.0536094,
                -32.95060939,
                0.186473988,
                10.28497398,
                -33.18845126,
                -0.697284609,
                -59.90978461,
                18.90171539,
            ],
            "DV90": [
                1171.567629,
                271.6940231,
                -232.3355694,
                -45.01145839,
                -177.6461342,
                -135.5744219,
                -9.377796912,
                73.42399479,
                -50.05582809,
                -40.47011979,
                -10.79941143,
                -71.22484447,
                -63.09151127,
                -91.87817762,
                3.579155729,
            ],
            "V100": [
                1.091768709,
                -0.696455954,
                2.027892232,
                0.214043695,
                1.862917065,
                -0.284031636,
                -0.086364594,
                -0.13072501,
                -0.43473524,
                1.555045677,
                0.086391552,
                -0.045061883,
                0.738328451,
                0.803398284,
                0.342852784,
            ],
            "V141": [
                2.589915288,
                -1.540158871,
                3.502992963,
                0.525401519,
                3.435328408,
                -0.242821771,
                -0.202897437,
                -0.347733687,
                -0.798953896,
                2.445199438,
                0.139297771,
                0.071120108,
                1.240600275,
                1.477830275,
                0.550825275,
            ],
            "V200": [
                5.865610608,
                -3.344007991,
                6.143223935,
                1.152127213,
                6.187003269,
                -0.073605532,
                -0.498266947,
                -0.748107115,
                -1.425071969,
                3.800284197,
                0.168522865,
                0.576880235,
                2.096456903,
                2.632311736,
                0.806555735,
            ],
        },
        "CP11TT 40°FF": {
            "Orifice": [4, 6, 8, 10, 12, 15, 20, 25, 30],
            "Flow": [0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 2.5, 3.0],
            "Angle": [0, 15, 30, 45],
            "Adjust": [16, 14, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                219.1273917,
                36.28520185,
                -41.84287659,
                -13.73625553,
                -37.04766366,
                -21.53068396,
                4.017302925,
                14.43611875,
                -23.01958757,
                6.691460417,
                -11.33164375,
                -12.43835785,
                -7.535430038,
                -4.503330038,
                -12.81926337,
            ],
            "DV50": [
                531.6870191,
                123.4245472,
                -85.31013342,
                -30.15952086,
                -85.46380341,
                -53.42786108,
                -6.370645162,
                32.45938021,
                -59.41631248,
                21.21615521,
                -24.21198021,
                -55.57298201,
                -28.20524063,
                -15.22394063,
                -37.40124063,
            ],
            "DV90": [
                1003.501083,
                280.7904574,
                -157.8267321,
                -42.87710079,
                -172.3138589,
                -97.74505068,
                -14.14103328,
                53.41300417,
                -123.878019,
                17.4699625,
                -46.97012083,
                -107.4298352,
                -69.07592919,
                -48.83889586,
                -54.37042919,
            ],
            "V100": [
                1.327609272,
                -0.534093133,
                1.696533196,
                0.81339217,
                1.708768853,
                -0.210883629,
                -0.35304581,
                -0.614752123,
                0.201735193,
                1.031060902,
                0.491629673,
                0.48218652,
                1.087548208,
                0.368172841,
                0.609541708,
            ],
            "V141": [
                3.126067074,
                -2.25000323,
                3.257871039,
                2.050626622,
                3.81559689,
                -0.760571718,
                -0.940569486,
                -1.225828358,
                0.052659251,
                1.891405175,
                1.171587175,
                2.003427344,
                2.063399093,
                0.713900193,
                1.43247676,
            ],
            "V200": [
                7.258966772,
                -6.313445951,
                5.509717303,
                4.10672684,
                7.481320667,
                -1.318280785,
                -1.668077153,
                -2.444272445,
                0.093542969,
                2.596858414,
                2.16460457,
                6.084934431,
                3.532360755,
                1.233549055,
                2.725279089,
            ],
        },
        "CP11TT 80°FF": {
            "Orifice": [2, 3, 4, 5, 6, 8, 10, 12, 15, 20, 25, 30],
            "Flow": [0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 3.0],
            "Angle": [0, 15, 30, 45],
            "Adjust": [16, 14, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                178.3055066,
                31.73005833,
                -22.98915331,
                -8.809188424,
                -28.1366163,
                -3.165000879,
                -0.659924711,
                9.542861458,
                -24.87200352,
                6.470038542,
                -1.950138542,
                -19.45153406,
                -15.40302547,
                2.975974529,
                -13.2493588,
            ],
            "DV50": [
                419.9750631,
                93.87686852,
                -37.51846319,
                -18.15262678,
                -72.26932452,
                -16.10912867,
                -1.567407165,
                18.24277292,
                -61.03165643,
                29.74716875,
                -1.581727083,
                -61.77812609,
                -26.96677429,
                6.736225706,
                -48.17510763,
            ],
            "DV90": [
                771.983463,
                204.2539907,
                -75.29754892,
                -33.38229865,
                -143.7813535,
                -42.06333058,
                -2.752463043,
                32.29471875,
                -122.1023743,
                54.69165625,
                -12.85269792,
                -119.0688071,
                -43.97140913,
                7.3694242,
                -101.3275758,
            ],
            "V100": [
                1.841075671,
                -2.753381387,
                2.617399207,
                0.851128717,
                2.380745387,
                -1.865516133,
                -0.010227879,
                -1.212233231,
                0.759907899,
                0.979381498,
                0.501509144,
                2.683068125,
                1.463841402,
                0.511927236,
                1.409456736,
            ],
            "V141": [
                4.806500212,
                -6.205608839,
                3.623371045,
                2.413889939,
                4.725202011,
                -3.387354283,
                -0.203823691,
                -2.824842181,
                2.200746121,
                0.945270506,
                1.130595277,
                6.318206277,
                2.713206923,
                0.613214423,
                3.13380759,
            ],
            "V200": [
                11.5865957,
                -13.73962885,
                3.405037889,
                5.249785924,
                9.157334664,
                -3.965516795,
                -1.595716089,
                -5.070979733,
                4.424876502,
                -0.638884046,
                2.111536163,
                14.66721627,
                4.328595808,
                0.473176641,
                5.892538808,
            ],
        },
        "CP11TT SS": {
            "Orifice": [6, 8, 10, 12, 15, 20, 25],
            "Flow": [0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 2.5],
            "Angle": [0, 15],
            "Adjust": [15.5, 9.5, 100, 20, 45, 15, 7.5, 7.5],
            "Speed": [70, 120],
            "DV10": [
                354.8861844,
                -9.474195931,
                -100.8257945,
                12.20118386,
                -46.75995522,
                -12.1579633,
                -9.115626992,
                19.81136542,
                22.01442649,
                19.4071276,
                22.0785268,
                -68.14689878,
                11.68552613,
                -0.871492785,
                35.62033949,
            ],
            "DV50": [
                778.7613614,
                -11.01201856,
                -203.3350599,
                41.69937684,
                -121.3210957,
                -21.95551239,
                -36.04902517,
                25.19761987,
                55.91855485,
                46.31670119,
                16.95701719,
                -97.64733061,
                37.8750344,
                -35.33679342,
                58.17199332,
            ],
            "DV90": [
                1467.352381,
                37.99191847,
                -283.7195437,
                116.3526577,
                -176.6462901,
                -27.14796432,
                -32.86951944,
                49.41172027,
                64.23416709,
                17.69724204,
                -7.272540239,
                -75.65301395,
                -17.04171884,
                -86.35544905,
                46.7981942,
            ],
            "V100": [
                0.607426245,
                0.016057054,
                0.456797833,
                -0.190323548,
                0.15127964,
                0.158631369,
                0.011148668,
                -0.215629218,
                -0.094194686,
                0.046555138,
                -0.053362804,
                0.09230205,
                0.27238491,
                -0.051847132,
                -0.145772762,
            ],
            "V141": [
                1.284918264,
                0.063728071,
                1.045444534,
                -0.448032917,
                0.353345592,
                0.363089563,
                0.049935203,
                -0.415367635,
                -0.249924464,
                0.102523542,
                -0.142090005,
                0.275393632,
                0.593633429,
                -0.101509386,
                -0.261074425,
            ],
            "V200": [
                2.880131433,
                0.107382584,
                2.306270353,
                -0.968690224,
                0.893329495,
                0.786047411,
                0.204358723,
                -0.711284532,
                -0.658801065,
                0.199487203,
                -0.371409213,
                0.832933939,
                1.11610757,
                -0.147488525,
                -0.478426534,
            ],
        },
        "Standard 40°FF": {
            "Orifice": [2, 4, 6, 8, 10, 12, 15, 20, 30],
            "Flow": [0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 3.0],
            "Angle": [0, 15, 30, 45],
            "Adjust": [16, 14, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                219.2089769,
                38.11536938,
                -38.78514533,
                -10.92782128,
                -14.29929997,
                -25.09271711,
                -43.24512717,
                -10.70277934,
                3.506518751,
                -11.18570738,
                -2.869774042,
                -22.69767183,
                -10.65752221,
                15.88926026,
                8.258572786,
            ],
            "DV50": [
                532.2048036,
                127.1316611,
                -88.45966387,
                -52.28898739,
                -31.64650032,
                -63.61088927,
                -87.51491713,
                -22.54663257,
                -7.211121679,
                -33.86920723,
                -11.69190723,
                -55.93863226,
                -36.2134175,
                34.90317,
                23.67411929,
            ],
            "DV90": [
                1003.435061,
                286.7619294,
                -176.5220891,
                -104.6982004,
                -45.62957233,
                -130.6291928,
                -161.4785949,
                -43.8831169,
                -15.20800706,
                -51.22619761,
                -45.69466428,
                -102.7990208,
                -73.68922587,
                57.82115562,
                21.5331834,
            ],
            "V100": [
                1.283137628,
                -0.487399685,
                1.62481562,
                0.461121903,
                0.853255159,
                0.148489438,
                1.597534513,
                0.446817063,
                -0.349321504,
                0.591919811,
                0.350550944,
                -0.294604638,
                1.290492273,
                -0.674567213,
                1.141686911,
            ],
            "V141": [
                3.019027873,
                -2.140523617,
                3.637013104,
                1.92954848,
                2.127214319,
                -0.072020296,
                3.038288092,
                1.085516366,
                -0.930450297,
                1.366794801,
                0.648218234,
                -0.969261461,
                2.598089384,
                -1.33717686,
                2.136572689,
            ],
            "V200": [
                7.086140188,
                -6.145478221,
                7.20056793,
                5.960003209,
                4.247282913,
                -0.097805415,
                5.160880703,
                2.006781503,
                -1.634195395,
                2.612982966,
                1.121252933,
                -1.664843274,
                4.406068894,
                -2.666600552,
                2.986205281,
            ],
        },
        "Standard 80°FF": {
            "Orifice": [2, 4, 6, 8, 10, 12, 15, 20, 30],
            "Flow": [0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5, 2.0, 3.0],
            "Angle": [0, 15, 30, 45],
            "Adjust": [16, 14, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                189.0771397,
                30.13222204,
                -25.72681106,
                -22.6996027,
                -4.219383884,
                -20.84321566,
                -14.94350195,
                4.224099306,
                -6.409580467,
                -14.51498683,
                4.78817984,
                -12.59829678,
                -19.78060989,
                10.04456875,
                11.01143407,
            ],
            "DV50": [
                447.3846791,
                98.94941591,
                -66.44140668,
                -67.6707804,
                -14.2351896,
                -48.9183376,
                -26.31136884,
                3.754701946,
                -6.466937947,
                -49.27887256,
                -0.044705896,
                -26.04135468,
                -37.20320425,
                18.40913318,
                29.76115285,
            ],
            "DV90": [
                828.3361423,
                224.5705846,
                -134.4892761,
                -124.0067259,
                -23.54348202,
                -96.03962323,
                -61.95582431,
                -1.910331465,
                -5.359525607,
                -98.25294917,
                -19.85228251,
                -60.7664946,
                -59.40071445,
                33.30029893,
                49.52876519,
            ],
            "V100": [
                1.658024742,
                -1.95626323,
                1.698949011,
                2.361651766,
                -0.201458479,
                0.705739196,
                0.893652059,
                -0.650156553,
                0.87260044,
                0.976925434,
                0.153703268,
                0.33447929,
                1.389512041,
                -1.340118848,
                -0.189297457,
            ],
            "V141": [
                4.053733511,
                -6.088698965,
                4.333909071,
                6.540365985,
                0.337312638,
                0.662566853,
                0.390928217,
                -1.108906621,
                1.321183788,
                2.291034701,
                0.402913868,
                1.124279863,
                2.865077986,
                -2.510186229,
                -1.295317719,
            ],
            "V200": [
                9.382785172,
                -15.11460556,
                9.028082443,
                15.99985347,
                2.682101071,
                0.98427853,
                -1.252077969,
                -1.328560603,
                0.460478405,
                4.756278211,
                0.711647044,
                2.550559043,
                5.377468418,
                -4.26832735,
                -3.020818416,
            ],
        },
        "Steel Disc Core SS": {
            "Orifice": [2, 3, 4, 5, 6, 7, 8, 10, 12],
            "Flow": [0.2, 0.27, 0.45, 0.74, 1.05, 1.41, 1.86, 2.71, 3.42],
            "Angle": [0, 15],
            "Adjust": [9, 7, 100, 20, 45, 15, 7.5, 7.5],
            "Speed": [70, 120],
            "DV10": [
                316.0828175,
                -101.975301,
                -121.2104445,
                -2.455156809,
                -36.226985,
                42.99506899,
                23.34815669,
                58.24634548,
                46.27373049,
                57.35695967,
                18.19888828,
                42.04444999,
                3.282669773,
                22.88991848,
                -7.982531824,
            ],
            "DV50": [
                810.1445803,
                -152.4594229,
                -232.5829672,
                33.86875505,
                -76.88434308,
                30.90144109,
                -13.91022159,
                40.94204909,
                53.76179229,
                57.89517537,
                2.088603655,
                -45.36273003,
                -7.41719327,
                11.95949342,
                -25.1731651,
            ],
            "DV90": [
                1627.502038,
                -146.1069509,
                -324.7392687,
                79.75314508,
                -104.7135994,
                -6.138551786,
                -58.93253644,
                52.84135378,
                8.422573929,
                78.94149322,
                -1.642326483,
                -289.2714522,
                -60.02088147,
                54.33117277,
                -69.49484432,
            ],
            "V100": [
                0.568279958,
                0.556928948,
                0.786234426,
                -0.098259352,
                0.050173445,
                0.71823002,
                -0.132247368,
                -0.248569102,
                0.009708329,
                -0.053742783,
                -0.113937425,
                0.783872202,
                0.462217579,
                -0.158293233,
                -0.316487333,
            ],
            "V141": [
                1.292812472,
                1.285279209,
                1.689294482,
                -0.250477449,
                0.099264323,
                1.412208228,
                -0.218291639,
                -0.487913665,
                0.04426412,
                -0.093102613,
                -0.235599525,
                1.480838846,
                0.924677014,
                -0.265534384,
                -0.596806011,
            ],
            "V200": [
                3.0002407,
                2.652917343,
                3.435137223,
                -0.569342324,
                0.277921573,
                2.49943865,
                -0.306435398,
                -0.918537002,
                0.075566662,
                -0.164438513,
                -0.437533359,
                2.646954875,
                1.676215578,
                -0.365271975,
                -1.074339469,
            ],
        },
        "Ceramic Disc Core SS": {
            "Orifice": [2, 4, 6, 8, 10],
            "Flow": [0.2, 0.45, 1.05, 1.86, 2.71],
            "Angle": [0, 15],
            "Adjust": [6, 4, 100, 20, 45, 15, 7.5, 7.5],
            "Speed": [70, 120],
            "DV10": [
                376.3672987,
                -62.13697621,
                -151.3552238,
                0.539519632,
                -69.7047277,
                52.03122537,
                11.40302651,
                54.60334414,
                67.99126125,
                16.71721036,
                15.1857523,
                34.21243527,
                2.938948445,
                -32.13833321,
                53.50306716,
            ],
            "DV50": [
                885.0390417,
                -50.32788511,
                -293.9227581,
                50.82366064,
                -127.9211651,
                48.05034509,
                4.911204271,
                70.28532429,
                76.88107043,
                14.38508309,
                -1.618646529,
                67.70533657,
                -17.97539412,
                -99.40760271,
                85.74843469,
            ],
            "DV90": [
                1600.572375,
                57.98640449,
                -368.3654253,
                111.8713104,
                -159.9266532,
                76.50367236,
                -26.29857033,
                71.24581682,
                63.23453497,
                -78.58731303,
                21.58159501,
                14.53976555,
                -34.44883905,
                -122.0950927,
                56.95190851,
            ],
            "V100": [
                0.426089329,
                -0.078443144,
                0.515700905,
                -0.056830903,
                0.219275871,
                0.072751211,
                -0.076791528,
                -0.220674571,
                -0.105696398,
                0.217879575,
                0.044965717,
                0.133734298,
                0.262979993,
                0.148052855,
                -0.166604492,
            ],
            "V141": [
                0.896048739,
                -0.060994094,
                1.142803791,
                -0.177818292,
                0.419518446,
                0.158576362,
                -0.111283847,
                -0.468826813,
                -0.209417936,
                0.44179299,
                0.074448686,
                0.319324851,
                0.526597918,
                0.340961432,
                -0.335487947,
            ],
            "V200": [
                2.028469463,
                0.007995724,
                2.520139772,
                -0.48432777,
                0.88701304,
                0.241014557,
                -0.091354586,
                -0.988313675,
                -0.459781708,
                0.920527474,
                0.081263355,
                0.662312023,
                0.989362959,
                0.80604953,
                -0.651822837,
            ],
        },
        "CP09 Deflection": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Flow": [0.635, 0.95, 1.972, 2.575],
            "Angle": [5, 30],
            "Adjust": [0.117, 0.055, 85, 35, 45, 15, 17.5, 12.5],
            "Speed": [50, 120],
            "DV10": [
                216.9058914,
                29.83699727,
                -89.38281567,
                -7.912832368,
                -25.87639211,
                -31.1212433,
                5.80000466,
                24.07027598,
                -12.13990612,
                -0.203251495,
                5.532043673,
                -12.78923422,
                4.851036039,
                8.705661064,
                0,
            ],
            "DV50": [
                536.6678645,
                106.4013005,
                -210.0515014,
                -11.65238605,
                -84.36072414,
                -109.6685132,
                24.84072139,
                52.11769877,
                -19.04666106,
                17.35296364,
                13.3061057,
                -13.10744469,
                -1.673295726,
                -6.267571622,
                0,
            ],
            "DV90": [
                1020.525886,
                201.0977487,
                -368.7465372,
                24.67927698,
                -208.5754174,
                -152.2264135,
                67.056449,
                27.16366959,
                -7.056965868,
                4.238209399,
                -17.65236187,
                105.5908907,
                -31.44252998,
                -96.40739106,
                0,
            ],
            "V100": [
                2.003274098,
                -0.434215369,
                2.732366221,
                -0.164579539,
                0.789934427,
                -0.500798228,
                0.264104742,
                -0.077363519,
                -0.093807332,
                0.997867066,
                -0.1190333,
                0.081068107,
                1.418471211,
                -0.490526221,
                0,
            ],
            "V141": [
                4.403672779,
                -1.116979265,
                5.275130999,
                -0.116084483,
                1.536543211,
                -0.729010769,
                0.216030575,
                -0.41067146,
                -0.225108614,
                1.717450223,
                -0.101555335,
                0.433718301,
                2.514396968,
                -0.719824219,
                0,
            ],
            "V200": [
                9.154124815,
                -2.729986391,
                9.741327048,
                0.132177497,
                3.087564199,
                -0.809180577,
                -0.129680532,
                -1.532920792,
                -0.724035561,
                2.854123311,
                0.160363384,
                1.697841677,
                4.061584827,
                -0.684447467,
                0,
            ],
        },
        "Davidon TriSet Deflection": {
            "Orifice": [0.062, 0.078, 0.125],
            "Flow": [0.682, 1.062, 2.454],
            "Angle": [22.5, 45],
            "Adjust": [0.0935, 0.0315, 85, 35, 45, 15, 33.75, 11.25],
            "Speed": [50, 120],
            "DV10": [
                182.0652556,
                -9.400924303,
                -68.67591783,
                -20.51988529,
                -15.05034064,
                17.60712433,
                0.37072525,
                36.31205057,
                -20.57583999,
                -10.23873262,
                -8.389403832,
                -29.75238696,
                8.968200018,
                26.43202963,
                0,
            ],
            "DV50": [
                424.0966316,
                9.087968198,
                -114.3327982,
                -31.92111405,
                -50.85292505,
                19.41083249,
                -4.908823265,
                63.55076975,
                -38.57574145,
                15.39156909,
                -20.46042581,
                -75.74971288,
                -10.06906183,
                52.61087443,
                0,
            ],
            "DV90": [
                787.6960913,
                66.30567113,
                -242.238634,
                -8.55596205,
                -125.1025018,
                4.329743041,
                -9.152904956,
                60.35110146,
                -49.61423986,
                60.00478753,
                -59.58105021,
                -218.6967645,
                14.9021438,
                122.2963715,
                0,
            ],
            "V100": [
                3.143671989,
                0.396114392,
                3.350933456,
                0.161347914,
                1.152493999,
                -0.297710375,
                0.354406785,
                -0.313539986,
                0.312579607,
                1.225302097,
                0.12902644,
                -0.060023672,
                1.475437791,
                -0.31862143,
                0,
            ],
            "V141": [
                6.759494024,
                0.751332426,
                6.188601559,
                0.419390009,
                2.022893449,
                -1.027693232,
                0.676849673,
                -0.815555282,
                0.80823847,
                2.078237948,
                0.158792287,
                0.102267412,
                2.593802849,
                -0.843233353,
                0,
            ],
            "V200": [
                14.02930745,
                1.335987017,
                10.77488074,
                1.274582197,
                3.68727596,
                -3.129132668,
                1.449920805,
                -2.277096074,
                1.995968019,
                3.043916257,
                0.448076127,
                1.195284179,
                4.791718525,
                -2.277648964,
                0,
            ],
        },
        "CP03": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Flow": [0.68, 1.02, 2.454, 3.37],
            "Angle": [30, 55, 90],
            "Adjust": [0.1165, 0.0555, 85, 35, 45, 15, 60, 30],
            "Speed": [50, 120],
            "DV10": [
                155.702232,
                15.17691802,
                -55.05954569,
                -7.333275959,
                -35.8510031,
                -7.885782681,
                -3.893117554,
                7.970347028,
                -10.50766235,
                9.387747514,
                4.31424512,
                3.858033102,
                -8.282866934,
                6.478796254,
                18.9872402,
            ],
            "DV50": [
                364.1358697,
                69.5290353,
                -114.6227543,
                -18.20600246,
                -88.15599112,
                -46.23724339,
                -3.087887541,
                18.53191406,
                -14.48602356,
                34.46439217,
                4.484461913,
                -2.682037577,
                -29.84247623,
                5.915297059,
                53.46762916,
            ],
            "DV90": [
                684.8724275,
                151.3475441,
                -227.1888947,
                1.631891727,
                -231.292243,
                -69.20453077,
                10.18758426,
                4.099656291,
                -42.22755672,
                87.39201857,
                -38.78058586,
                -74.52972519,
                -30.3856709,
                -0.323053347,
                120.4365361,
            ],
            "V100": [
                3.500621687,
                -0.546510574,
                3.8380492,
                -0.042053645,
                1.797871773,
                -0.702280625,
                0.205709167,
                -0.122056355,
                0.024040498,
                2.039677902,
                -0.246457172,
                0.272979558,
                1.541565971,
                -0.303537527,
                -0.493420373,
            ],
            "V141": [
                7.664580934,
                -1.799638157,
                7.052179187,
                0.004360727,
                3.406076031,
                -1.062238544,
                0.202095402,
                -0.320847701,
                -0.614316332,
                3.265877151,
                -0.562212257,
                0.783199848,
                2.976337034,
                -0.399270509,
                -1.321837282,
            ],
            "V200": [
                16.03376677,
                -5.307941997,
                11.9635462,
                1.046468393,
                6.853445456,
                -0.136993781,
                -1.407875846,
                -1.526131175,
                -2.538867784,
                4.143597448,
                0.004473862,
                2.081648243,
                6.253970521,
                0.787216486,
                -3.71103203,
            ],
        },
        "Steel Disc Core 45": {
            "Orifice": [2, 4, 6, 8, 10, 12, 14, 16],
            "Flow": [0.2, 0.36, 0.58, 0.84, 1.1, 1.36, 1.53, 1.79],
            "Angle": [0, 15, 30, 45],
            "Adjust": [9, 7, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                141.2940105,
                9.015011633,
                -13.04822198,
                -21.89044389,
                -0.296100297,
                2.05912662,
                4.777027874,
                5.367752584,
                6.830133048,
                -13.19451152,
                -5.971788424,
                -44.92867524,
                -21.64009517,
                23.98766733,
                14.4089048,
            ],
            "DV50": [
                320.1517496,
                26.4098746,
                -31.05929358,
                -56.22400817,
                -3.901235189,
                1.309095282,
                8.855152658,
                11.51871675,
                15.18088217,
                -24.96495621,
                -17.47789044,
                -102.5287616,
                -46.96282987,
                60.06677449,
                33.4056598,
            ],
            "DV90": [
                590.663322,
                54.12796869,
                -87.37993762,
                -124.0401991,
                21.19352985,
                6.726728497,
                20.76442155,
                14.69820848,
                50.37460799,
                -58.15409447,
                -50.74940876,
                -242.1561991,
                -84.97032064,
                155.0651819,
                91.76179445,
            ],
            "V100": [
                4.451091483,
                -2.063751621,
                1.860963554,
                2.6499336,
                -0.038335923,
                0.006938296,
                -0.779216008,
                -0.14091574,
                -0.958642203,
                2.235793033,
                0.944209774,
                7.126614895,
                2.011884114,
                -2.999633652,
                -2.070021003,
            ],
            "V141": [
                10.12974188,
                -3.970380631,
                2.675730662,
                5.751251153,
                0.096484405,
                -0.479649749,
                -1.343661618,
                -0.381205226,
                -1.735247478,
                3.817854377,
                2.292554821,
                13.83358991,
                4.121431513,
                -5.789842359,
                -3.889446748,
            ],
            "V200": [
                21.70584841,
                -6.812145426,
                4.386206534,
                10.11263274,
                0.813685265,
                -1.025266282,
                -2.09844909,
                -0.684895201,
                -2.999821527,
                6.036726662,
                4.434779488,
                23.17666098,
                7.560667298,
                -9.971703602,
                -6.121201702,
            ],
        },
        "Ceramic Disc Core 45": {
            "Orifice": [2, 4, 6, 8, 10],
            "Flow": [0.2, 0.36, 0.58, 0.84, 1.1],
            "Angle": [0, 15, 30, 45],
            "Adjust": [6, 4, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                114.5804014,
                21.12796924,
                -11.21679257,
                -9.458104677,
                -4.936797333,
                -2.170606667,
                -2.703258076,
                3.662416408,
                -1.2045983,
                -2.460874855,
                3.01175007,
                -2.283669849,
                -6.9932106,
                7.12237917,
                4.972359583,
            ],
            "DV50": [
                260.2456333,
                51.59092919,
                -21.56389063,
                -20.56838617,
                -15.78463091,
                -6.523838762,
                -7.743147994,
                9.228309434,
                -3.150488403,
                -3.172598313,
                6.412233865,
                -2.806296718,
                -15.58648348,
                9.363007963,
                5.162803101,
            ],
            "DV90": [
                474.7400441,
                108.9529069,
                -41.7766989,
                -25.46337552,
                -16.0900077,
                -18.85330306,
                0.195064511,
                12.73333799,
                3.052049336,
                -2.480451185,
                15.54972573,
                -0.896722726,
                -12.48312458,
                -1.827145112,
                6.255363155,
            ],
            "V100": [
                7.929670422,
                -3.721120706,
                1.938282782,
                1.201121504,
                0.989321413,
                -0.569255792,
                -0.494849561,
                -0.169281259,
                -0.829424722,
                0.941319732,
                -0.926071547,
                1.620650428,
                0.715181334,
                -1.253653723,
                -0.706180984,
            ],
            "V141": [
                15.99872486,
                -7.486238352,
                2.983143554,
                2.313388984,
                2.351326858,
                -1.066334631,
                -0.543959958,
                -0.868181434,
                -1.873579586,
                1.379542905,
                -1.620227772,
                3.240106078,
                2.020428213,
                -2.232457009,
                -0.484705698,
            ],
            "V200": [
                31.9986384,
                -12.3990611,
                4.477653527,
                4.264217408,
                3.963849241,
                -1.032801563,
                -0.267055708,
                -1.894560148,
                -2.200312576,
                1.76993932,
                -1.765885834,
                4.176174254,
                4.050609669,
                -3.389750369,
                -0.149835164,
            ],
        },
        "CP09 SS": {
            "Orifice": [0.062, 0.078, 0.125, 0.172],
            "Flow": [0.635, 0.95, 1.972, 2.575],
            "Angle": [0],
            "Adjust": [0.117, 0.055, 95, 25, 45, 15, 0, 1],
            "Speed": [70, 120],
            "DV10": [
                417.5952066,
                -38.55591542,
                -171.0469561,
                -4.378219905,
                0,
                6.047018631,
                53.02142109,
                15.57331958,
                0,
                0,
                0,
                -73.94702787,
                58.74067092,
                -40.60615244,
                0,
            ],
            "DV50": [
                955.8739287,
                -7.690867577,
                -361.3222055,
                58.15538876,
                0,
                -32.13884237,
                66.60151081,
                -11.11273067,
                0,
                0,
                0,
                -151.9264446,
                94.1492494,
                -59.811651,
                0,
            ],
            "DV90": [
                1617.240107,
                38.58328146,
                -487.3806319,
                170.170865,
                0,
                -22.99288497,
                70.16445412,
                -55.42065666,
                0,
                0,
                0,
                -109.274331,
                121.1757315,
                -121.2615425,
                0,
            ],
            "V100": [
                0.513294693,
                0.482624802,
                0.8660842,
                -0.196848554,
                0,
                0.363541261,
                -0.191401695,
                -0.204134034,
                0,
                0,
                0,
                -0.075910757,
                0.479428439,
                0.044773387,
                0,
            ],
            "V141": [
                1.213041599,
                1.020347764,
                1.886622989,
                -0.391887262,
                0,
                0.752889591,
                -0.391319298,
                -0.406799805,
                0,
                0,
                0,
                -0.125850907,
                1.005460476,
                0.075855614,
                0,
            ],
            "V200": [
                2.737652336,
                1.9787066,
                3.883231211,
                -0.722026119,
                0,
                1.401265061,
                -0.768094626,
                -0.765284557,
                0,
                0,
                0,
                -0.163144639,
                1.953909997,
                0.138182266,
                0,
            ],
        },
        "Davidon TriSet SS": {
            "Orifice": [0.061, 0.078, 0.125],
            "Flow": [0.682, 1.062, 2.454],
            "Angle": [0],
            "Adjust": [0.0935, 0.0315, 95, 25, 45, 15, 0, 1],
            "Speed": [70, 120],
            "DV10": [
                498.0238857,
                -119.5143909,
                -363.9461956,
                71.74001985,
                0,
                85.06570969,
                -19.39135071,
                -22.88680208,
                0,
                0,
                0,
                43.50371602,
                169.9693162,
                -67.71818382,
                0,
            ],
            "DV50": [
                1148.700701,
                -69.36880147,
                -619.0458308,
                172.3496474,
                0,
                21.59784798,
                -7.909067216,
                -32.82854167,
                0,
                0,
                0,
                -43.01182118,
                199.7622843,
                -24.97004902,
                0,
            ],
            "DV90": [
                1818.000004,
                -6.05877451,
                -696.2853339,
                204.8039163,
                0,
                5.897776092,
                -21.84931859,
                72.92314583,
                0,
                0,
                0,
                -63.27203287,
                195.3446275,
                -6.127539216,
                0,
            ],
            "V100": [
                0.246265521,
                0.168691099,
                0.50943031,
                -0.197573837,
                0,
                0.15404704,
                -0.032838197,
                -0.196654052,
                0,
                0,
                0,
                -0.096669497,
                0.294889517,
                0.098462017,
                0,
            ],
            "V141": [
                0.585002478,
                0.384004919,
                1.156960948,
                -0.42764657,
                0,
                0.346887213,
                -0.074239013,
                -0.431042656,
                0,
                0,
                0,
                -0.185618166,
                0.637229179,
                0.220702679,
                0,
            ],
            "V200": [
                1.311112955,
                0.793383185,
                2.527905744,
                -0.877823149,
                0,
                0.707114312,
                -0.138553757,
                -0.911757938,
                0,
                0,
                0,
                -0.295727287,
                1.326916779,
                0.464113279,
                0,
            ],
        },
        "CP11TT 110°FF": {
            "Orifice": [4, 6, 8],
            "Flow": [0.4, 0.6, 0.8],
            "Angle": [0, 15, 30, 45],
            "Adjust": [6, 2, 85, 35, 45, 15, 22.5, 22.5],
            "Speed": [50, 120],
            "DV10": [
                171.9391161,
                18.54533241,
                -15.88783241,
                -4.414769444,
                -2.734362037,
                -5.409717708,
                -3.996188542,
                2.630605208,
                -1.983709375,
                -15.19816563,
                3.443446875,
                -6.20291323,
                -26.8950799,
                -0.619079896,
                -19.03691323,
            ],
            "DV50": [
                332.7120073,
                35.9465037,
                -24.93404074,
                -14.47658889,
                -21.30445,
                -10.04626458,
                -6.031172917,
                5.337527083,
                -8.929808333,
                -19.4505875,
                2.692629167,
                -8.875786347,
                -32.53411968,
                3.04888032,
                -35.26545301,
            ],
            "DV90": [
                544.5983571,
                65.71223704,
                -35.62295926,
                -29.75339259,
                -57.45968889,
                -18.48693333,
                -8.017858333,
                7.774483333,
                -20.28742083,
                -27.4619125,
                5.335495833,
                -16.44602768,
                -34.85586102,
                4.359972316,
                -42.17652768,
            ],
            "V100": [
                1.390287783,
                -2.127432419,
                2.471428122,
                0.671492082,
                0.781029785,
                0.253858325,
                0.152170696,
                0.053009221,
                0.160929529,
                2.858237721,
                -0.5194332,
                1.850323142,
                3.265342809,
                0.565528809,
                0.813590142,
            ],
            "V141": [
                2.045235225,
                1.034579817,
                2.807453404,
                -0.270246998,
                -0.211346412,
                0.657125761,
                0.143267418,
                -0.287248158,
                0.235974931,
                -0.129949533,
                -0.094926336,
                -0.513455027,
                1.229175716,
                0.142185824,
                0.254042645,
            ],
            "V200": [
                15.11489389,
                -7.29840122,
                6.425341776,
                2.880548706,
                4.390102335,
                1.315033248,
                0.526027502,
                -0.087006481,
                0.99887094,
                6.561150623,
                -0.360128081,
                4.049032848,
                8.830587015,
                0.093034682,
                6.410628848,
            ],
        },
    }

    def __init__(
        self, nozzle=None, orifice=None, airspeed=None, pressure=None, angle=None
    ):
        self.nozzle = nozzle
        self.orifice = orifice
        self.airspeed = airspeed
        self.pressure = pressure
        self.angle = angle

    """
    This method is designed to be called internally, but may be called externally
    if needed. It is the heavy lifter, but is wrapped in convenience methods below
    """

    def _calc(
        self,
        nozzle=None,
        orifice=None,
        airspeed=None,
        pressure=None,
        angle=None,
        param=None,
    ):
        # shorthand helpers
        n = self.nozzle if nozzle is None else nozzle
        o = self.orifice if orifice is None else orifice
        a = self.airspeed if airspeed is None else airspeed
        p = self.pressure if pressure is None else pressure
        an = self.angle if angle is None else angle
        # Run a pre-check, coerces strings, checks bounds and finds correct model
        n, o, a, p, an, dict_ = self._calcPreCheck(n, o, a, p, an)
        if any([n is None, o is None, a is None, p is None, an is None, not dict_]):
            return -1
        # Catch if special GPM calculation and return that value
        if param == "GPM":
            # find gpm at 40 PSI
            gpm_40 = dict_[n]["Flow"][1]
            # Correct to initialized pressure
            gpm = gpm_40 * math.sqrt(p / 40)
            return gpm
        # Perform adjustment to the 4 input parameters to run the models
        o_a = (o - dict_[n]["Adjust"][0]) / dict_[n]["Adjust"][1]
        a_a = (a - dict_[n]["Adjust"][2]) / dict_[n]["Adjust"][3]
        p_a = (p - dict_[n]["Adjust"][4]) / dict_[n]["Adjust"][5]
        an_a = (an - dict_[n]["Adjust"][6]) / dict_[n]["Adjust"][7]
        # Make calculations for each droplet size parameter
        # Order of constants:
        # Intercept,Orifice,Airspeed,Pressure,Angle,Orf*AS,Orf*Press,AS*Press,Orf*Ang,
        # AS*Ang,Press*Ang,Orf^2,AS^2,Press^,Ang^2
        calc = (
            dict_[n][param][0]
            + o_a * dict_[n][param][1]
            + a_a * dict_[n][param][2]
            + p_a * dict_[n][param][3]
            + an_a * dict_[n][param][4]
            + o_a * a_a * dict_[n][param][5]
            + o_a * p_a * dict_[n][param][6]
            + a_a * p_a * dict_[n][param][7]
            + o_a * an_a * dict_[n][param][8]
            + a_a * an_a * dict_[n][param][9]
            + p_a * an_a * dict_[n][param][10]
            + (o_a**2) * dict_[n][param][11]
            + (a_a**2) * dict_[n][param][12]
            + (p_a**2) * dict_[n][param][13]
            + (an_a**2) * dict_[n][param][14]
        )
        return round(calc)

    """
    This method is designed to be called internally. It will attempt to match args to correct model,
    coerce orif and defl if given as str, check that all values either fall within model bounds or 
    are explicitly in the model. A tuple is returned with a positional None value if an arg is outside
    the model. If no model is found, an empty dict is returned in the last item of the tuple.
    """

    def _calcPreCheck(self, nozzle, orifice, airspeed, pressure, angle) -> tuple:
        # Differences between hs and ls model
        nozzle = self._parseNozzle(nozzle, airspeed, angle)
        # Is the nozzle/airspeed combo in either model?
        if not (model := self._getApplicableModel(nozzle, airspeed)):
            return None, orifice, None, pressure, angle, model
        # Coerce orifice if string
        if isinstance(orifice, str):
            orif_str_list = [str(o) for o in model[nozzle]["Orifice"]]
            if orifice in orif_str_list:
                orifice = model[nozzle]["Orifice"][orif_str_list.index(orifice)]
        # Coerce angle if string
        if isinstance(angle, str):
            angle_str_list = [str(o) for o in model[nozzle]["Angle"]]
            if angle in angle_str_list:
                angle = model[nozzle]["Angle"][angle_str_list.index(angle)]
        # Is orifice explicitly in applicable model?
        if orifice not in model[nozzle]["Orifice"]:
            return nozzle, None, airspeed, pressure, angle, model
        # Is angle explicitly in applicable model?
        if angle not in model[nozzle]["Angle"]:
            return nozzle, orifice, airspeed, pressure, None, model
        # Is pressure within range of applicable model?
        if model == self.ls_dict:
            if not 30 <= pressure <= 60:
                return nozzle, orifice, airspeed, None, angle, model
        else:
            if not 30 <= pressure <= 90:
                return nozzle, orifice, airspeed, None, angle, model
        # All good, notify
        return nozzle, orifice, airspeed, pressure, angle, model

    """
    This method is designed to be called internally. It accounts for differences
    in nozzle names in the LS and HS models. Nozzles without differences have thier 
    names passed, Nozzles with differences have their names altered to reflect which 
    model (LS or HS) their airspeed corresponds to.
    """

    def _parseNozzle(self, nozzle, airspeed, angle):
        if nozzle == "CP09":
            _nozzle = "CP09 SS" if int(angle) == 0 else "CP09 Deflection"
            if (
                self.ls_dict[_nozzle]["Speed"][0]
                <= airspeed
                < self.ls_dict[_nozzle]["Speed"][1]
            ):
                nozzle = "CP09 SS" if int(angle) == 0 else "CP09 Deflection"
        if nozzle == "Davidon TriSet":
            _nozzle = (
                "Davidon TriSet SS" if int(angle) == 0 else "Davidon TriSet Deflection"
            )
            if (
                self.ls_dict[_nozzle]["Speed"][0]
                <= airspeed
                < self.ls_dict[_nozzle]["Speed"][1]
            ):
                nozzle = (
                    "Davidon TriSet SS"
                    if int(angle) == 0
                    else "Davidon TriSet Deflection"
                )
        return nozzle

    """
    This method is designed to be called internally. It will return either a ref to
    the applicable xs_dict or an empty dict, based on input nozzle and airspeed.
    """

    def _getApplicableModel(self, nozzle, airspeed) -> dict:
        # Is airspeed within range in either model?
        if nozzle in self.hs_dict.keys():
            if (
                self.hs_dict[nozzle]["Speed"][0]
                <= airspeed
                < self.hs_dict[nozzle]["Speed"][1]
            ):
                return self.hs_dict
        if nozzle in self.ls_dict.keys():
            if (
                self.ls_dict[nozzle]["Speed"][0]
                <= airspeed
                < self.ls_dict[nozzle]["Speed"][1]
            ):
                return self.ls_dict
        # Not in either model
        return {}

    """
    This method is designed to be called internally, returning a list of available
    options for a requested parameter. This is used for external convenience methods
    of gettings lists of available orifice size and deflection.
    """

    def _params_for_nozzle(self, nozzle, param):
        nozzles = [nozzle]
        # Check if nozzle has alternate ss/def models
        if nozzle == "CP09":
            nozzles.extend(["CP09 SS", "CP09 Deflection"])
        if nozzle == "Davidon TriSet":
            nozzles.extend(["Davidon TriSet SS", "Davidon TriSet Deflection"])
        vals = []
        for n in nozzles:
            if n in self.hs_dict.keys():
                vals.extend(self.hs_dict[n][param])
            if n in self.ls_dict.keys():
                vals.extend(self.ls_dict[n][param])
            if n in self.excluded_dict.keys():
                if param == "Orifice" or param == "Angle":
                    vals.extend(self.excluded_dict[n][param])
        return sorted(set(vals))

    """
    This method is designed to be called internally, but may be called externally
    if needed. It will return a string abbreviation of the computed droplet spectrum
    category. dV01 and dV05 may be optionally supplied if calculated elsewhere.
    """

    def _dsc(self, dv01=None, dv05=None):
        r = self.ref_nozzles
        dsc_01, dsc_05 = "", ""
        if dv01 is None:
            dv01 = self.dv01()
        if dv05 is None:
            dv05 = self.dv05()
        if dv01 <= 0 or dv05 <= 0:
            return ""
        if np.isnan(dv01) or np.isnan(dv05):
            return ""
        for category in r.keys():
            if r[category]["DV01"][0] <= dv01 <= r[category]["DV01"][1]:
                dsc_01 = category
            if r[category]["DV05"][0] <= dv05 <= r[category]["DV05"][1]:
                dsc_05 = category
        dsc = dsc_05
        if r[dsc_01]["RANK"] < r[dsc_05]["RANK"]:
            dsc = dsc_01
        return dsc

    def _dsc_color(self, dsc) -> str:
        r = self.ref_nozzles
        color = "#FFFFFF"
        if dsc in r.keys():
            color = r[dsc]["Color"]
        return color

    def _dsc_color_dv(self, dv: int, dv_key: str) -> str:
        r = self.ref_nozzles
        color = "#FFFFFF"
        if dv > 0:
            for category in r.keys():
                if r[category][dv_key][0] <= dv <= r[category][dv_key][1]:
                    color = r[category]["Color"]
        return color

    def _rs(self, dv01=None, dv05=None, dv09=None):
        if dv01 is None:
            dv01 = self.dv01()
        if dv05 is None:
            dv05 = self.dv05()
        if dv09 is None:
            dv09 = self.dv09()
        return (dv09 - dv01) / dv05

    """
    The Methods to call externally to recieve a calculation. Will return
    an integer for dV and %V calculations
    """

    def dv01(self):
        return self._calc(param="DV10")

    def dv05(self):
        return self._calc(param="DV50")

    def dv09(self):
        return self._calc(param="DV90")

    def p_lt_100(self):
        return self._calc(param="V100")

    def p_lt_200(self):
        return self._calc(param="V200")

    """
    This method is used to call externally. It will return a string
    abbreviation of the computed droplet spectrum category. dV01 and dV05 may be
    optionally supplied if calculated elsewhere.
    """

    def dsc(self, dv01=None, dv05=None):
        return self._dsc(dv01, dv05)

    def dsc_color(self, dv01=None, dv05=None):
        return self._dsc_color(dsc=self._dsc(dv01=dv01, dv05=dv05))

    def dsc_color_dv01(self, dv01=None):
        if dv01 is None:
            dv01 = self.dv01()
        return self._dsc_color_dv(dv=dv01, dv_key="DV01")

    def dsc_color_dv05(self, dv05=None):
        if dv05 is None:
            dv05 = self.dv05()
        return self._dsc_color_dv(dv=dv05, dv_key="DV05")

    def dsc_color_dv09(self, dv09=None):
        if dv09 is None:
            dv09 = self.dv09()
        return self._dsc_color_dv(dv=dv09, dv_key="DV09")

    def rs(self, dv01=None, dv05=None, dv09=None):
        return self._rs(dv01, dv05, dv09)

    """
    This method is used to call externally to calculate the flow rate for a given
    orifice based on manufacturer specified flow at 40 PSI. This is not part of
    the USDA atomization model, but is employed here to facilitate flow-weighted
    mean droplet spectrum data as an estimate for composite spray setups.
    """

    def calc_gpm(self):
        return self._calc(param="GPM")

    """
    These methods are used to call externally to get available nozzle options. This
    is primarily needed to get over the quirks of the hs/ls model differences
    """

    def get_nozzles(self) -> list[str]:
        return self.nozzles_extended

    def get_orifices_for_nozzle(self, nozzle: str) -> list[str]:
        return self._params_for_nozzle(nozzle, "Orifice")

    def get_deflections_for_nozzle(self, nozzle: str) -> list[str]:
        return self._params_for_nozzle(nozzle, "Angle")


class AtomizationModelMulti(AtomizationModel):
    def __init__(self):
        self.nozzleSets = []

    def _calc_multi(self, param):
        numerator = 0
        denominator = 0
        for n in self.nozzleSets:
            # Run model
            size = self._calc(
                nozzle=n[0],
                orifice=n[1],
                airspeed=n[2],
                pressure=n[3],
                angle=n[4],
                param=param,
            )
            flow = self._calc(
                nozzle=n[0],
                orifice=n[1],
                airspeed=n[2],
                pressure=n[3],
                angle=n[4],
                param="GPM",
            )
            quantity = n[5]
            # add to num/denom for weighted mean calc
            numerator += size * flow * quantity
            denominator += flow * quantity
        # Catch situation with no nozzles
        if denominator == 0:
            return -1
        # calc weighted mean and return
        return round(numerator / denominator)

    def addNozzleSet(self, name, orifice, airspeed, pressure, angle, quantity):
        self.nozzleSets.append([name, orifice, airspeed, pressure, angle, quantity])

    def clearNozzleSets(self):
        self.nozzleSets = []

    """
    The Methods to call externally to recieve a calculation. Will return
    an integer for dV and %V calculations
    """

    def dv01(self):
        return self._calc_multi("DV10")

    def dv05(self):
        return self._calc_multi("DV50")

    def dv09(self):
        return self._calc_multi("DV90")

    def p_lt_100(self):
        return self._calc_multi("V100")

    def p_lt_200(self):
        return self._calc_multi("V200")
